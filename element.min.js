(()=>{const e=e=>{let t=new URLSearchParams(window.location.search).get(e);return t||(null===document.currentScript?null:(t=new URLSearchParams(document.currentScript.src.split("?")[1]).get(e),t))};e("log");const t=~~(e("flakecount")||300),s=~~(e("addflakes")||10),i=~~(e("maxflakes")||1e3),a=~~(e("maxnewflaketimout")||3e3);let n=e("fps")||30,o=0,r=s,l=0;const c="make-it-snow",h="snow-flake",d=["snow","ghostwhite","floralwhite","white","ivory","seashell","honeydew","aliceblue","azure","aliceblue","lightcyan","mintcream","lavender"],u=(e,t={})=>{const s=document.createElement(e);return Object.assign(s,t)},m=(e,t)=>u("counter-display",{labelPrefix:e,top:t}),p=(e,t)=>Array.isArray(e)?e[Math.floor(Math.random()*e.length)]:Math.random()*(t-e)+e,f=":host{display:inline-block;position:absolute;will-change:transform;--size:var(--flakesize,5%);width:var(--size)}svg{width:100%;vertical-align:top}",y=new CSSStyleSheet;y.replaceSync(f);const b=e("adopted")||!1;customElements.define(h,class extends HTMLElement{connectedCallback(){this.attachShadow({mode:"open"}),b&&(this.shadowRoot.adoptedStyleSheets=[y]);let e=this.getAttributeUrl("spikecount")||p([4,6,8]);this.shadowRoot.innerHTML=(b?"":`<style>${f}</style>`)+'<style id=animation>\x3c!--animation CSS injected here--\x3e</style><style id=style>\x3c!--initial state injected here--\x3e</style><svg part=crystal viewBox="0 0 140 140">'+`<g id="spike" transform="rotate(${this.rotate} 70 70)" fill=none stroke-linecap=round >`+["M70 70v-60","M45 28l25 18l28-16","M50 11l20 20l20-20"].map((e=>{let t=p(3,9);return`<path opacity="${p(.2,1)}" stroke-width="${t}" d="${e}"/>`})).join("")+"</g>"+Array(e-1).fill(360/e).map(((e,t)=>`<use href=#spike transform="rotate(${(t+1)*e} 70 70)"/>`)).join("")+"</svg>",this.frozenflake=this.hasAttribute("freeze")||this.getAttributeUrl("freeze"),this.position(),this.frozenflake||this.animate({}),this.onanimationend=()=>{this.remove()}}getAttributeUrl(t){let s=this.getAttribute(t);if(s=s||e(t),s=s||getComputedStyle(this).getPropertyValue(`--${t}`).trim(),s&&s.includes("-")){const[e,t]=s.split("-").map(Number);s=p(e,t)}else if(s&&s.includes(",")){const e=s.split(",");s=p(e)}return s}get color(){return this.getAttributeUrl("color")||p(d)}set color(e){this.setAttribute("color",e)}get x(){return this.getAttribute("x")||p(0,100)}set x(e){this.setAttribute("x",e)}get y(){return this.getAttribute("y")||p(-1,0)}set y(e){this.setAttribute("y",e)}get size(){let e=this.getAttributeUrl("size")||2;return e*=p(1,6),.5*~~e}set size(e){this.setAttribute("size",e)}get rotate(){return this.getAttributeUrl("rotate")||p(-90,90)}set rotate(e){this.setAttribute("rotate",e)}disconnectedCallback(){o--}position(e=this.x,t=this.y,s=this.color){this.getAttributeUrl("randomxy")&&(e=p(0,100),t=p(0,100)),this.x=e,this.y=t,this.shadowRoot.querySelector("#style").innerHTML=`#spike{stroke:${s}}:host{  left:calc(${e}% - calc(var(--size) / 2));  top :calc(${t}% - calc(var(--size) / 2))}`}get animspeed(){return~~(this.getAttributeUrl("speed")||p(8,24))}get drift(){let e=this.getAttributeUrl("drift")||5;return p(-e,e)}get cssrotate(){let e=this.getAttributeUrl("cssrotate")||2;return e*=p(-360,360),~~e}get animstyle(){return this.getAttributeUrl("animstyle")||"linear"}animate({speed:e=this.animspeed,cssrotate:t=this.cssrotate,x:s=this.x,y:i=this.y,top:a="120%",drift:n=this.drift}){let o=[~~s];for(let e=1;e<6;e++){let e=o[o.length-1]+n;o.push(~~e)}let r=Array.from({length:4},((e,t)=>Math.random()*(100-20*(t+1))+20*(t+1)));this.shadowRoot.querySelector("#animation").innerHTML=`@keyframes flakefall{0%{left:${o[0]};top:calc(-2 * var(--size));transform:rotate(0deg)}`+r.map(((e,t)=>`${~~e}%{left:${o[t]}%}`)).join("")+`100%{left:${o[5]}%;top:${a};transform:rotate(${t}deg)}}`+`:host{animation:flakefall ${e}s ${this.animstyle} 0s forwards}`}stop(){this.shadowRoot.querySelector("#animation").innerHTML=""}}),customElements.define(c,class extends HTMLElement{static get observedAttributes(){return["startflakecount","addflakecount","animationspeed"]}connectedCallback(){this.renderonce()}renderonce(){this.renderonce=()=>{};let s="no"==e("ui")?u("span"):u("snowflake-quotes");document.body.append(u("frames-per-second",{id:"FPS"}),this.flakecounter=m("total <snow-flake> Web Components : ",42),this.addflakecounter=m("new <snow-flake> per second: ",77),this.memoryusage=m("memory...",112),s),performance?.memory&&setInterval((()=>{const{usedJSHeapSize:e,totalJSHeapSize:t}=performance.memory;let s="heap MB "+(e/1e6).toFixed(2)+" / "+(t/1e6).toFixed(2);b&&(s="(adoptedstylesheet) "+s),this.memoryusage.shadowRoot.querySelector("div").textContent=s}),1e3),document.addEventListener(c,(()=>{(!this.lastUpdateTime||Date.now()-this.lastUpdateTime>=1e3)&&(this.flakecounter.label=o,this.addflakecounter.label=r,this.lastUpdateTime=Date.now());const e=document.createElement(h);this.append(e),o++}));for(let e=0;e<t;e++)setTimeout((()=>{document.dispatchEvent(new CustomEvent(c))}),4e3*e/t)}}),customElements.define("counter-display",class extends HTMLElement{#e=0;#t="";connectedCallback(){var t;"no"!=e("counters")&&this.attachShadow({mode:"open"}).append((t=`:host{position:fixed;z-index:999;opacity:.7;display:var(--snow-ui-display, inherit);top:${this.top||5}px;left:5px;background:#000;color:#fff;padding:5px;border-radius:5px;font:18px arial}`,u("style",{textContent:t})),this.div=u("div",{part:"div",textContent:"updating..."}))}get top(){return this.getAttribute("top")||10}set top(e){this.setAttribute("top",e)}get labelPrefix(){return this.#t}set labelPrefix(e){this.#t=e}get count(){return this.#e}set count(e){this.label=this.#e=e}get label(){return this.div.textContent}set label(e){this.div&&(this.div.textContent=(this.labelPrefix||"")+e)}}),customElements.define("frames-per-second",class extends HTMLElement{connectedCallback(e=0,s){const h=()=>s=m(`animation FPS (threshold:${n} ⬆️⬇️ keys) : `,5);this.attachShadow({mode:"open"}).append(s=h());let d=h=>{if(l++,h-e>=1e3){if(e=h,s.label=l,l>n&&t>0&&o<i){r+=5;for(let e=0;e<r;e++)setTimeout((()=>{document.dispatchEvent(new CustomEvent(c))}),p(0,a))}else r-=5,r<0&&(r=1);l=0}requestAnimationFrame(d)};requestAnimationFrame(d),document.addEventListener("keyup",(e=>{let t=e.ctrlKey?10:1;"ArrowUp"===e.key?n=Math.min(n+t,60):"ArrowDown"===e.key&&(n=Math.max(n-t,1)),s.replaceWith(s=h())}))}}),customElements.define("snowflake-quotes",class extends HTMLElement{connectedCallback(){const t=["You are not a special snowflake.--Sophia Amoruso","No snowflake in an avalanche ever feels responsible.--Stanislaw Jerzy Lec","It's so fascinating to think about how each snowflake is completely individual - there are millions and millions of them, but each one is so unique.--Kate Bush","They say that every snowflake is different. If that were true, how could the world go on? How could we ever get up off our knees? How could we ever recover from the wonder of it?--Jeanette Winterson","Every avalanche begins with the movement of a single snowflake, and my hope is to move a snowflake.--Thomas Frey","You are not a beautiful, unique snowflake... This is your life, and it's ending one minute at a time.--Chuck Palahniuk","I want people to know their palate is a snowflake. We all like different things. Why should we all have the same taste in wines?--Gary Vaynerchuk"];if("no"==e("quotes"))return;let s,i;const a=e=>`${e+1} of ${t.length}<br><br>`+t[s=e].replace("--","<br><br>-- "),n=(e=1e3)=>i=setInterval((()=>o()),Math.max(2e3,e)),o=()=>{clearInterval(i);let e=a((s+1)%t.length);n(60*e.length),this.div.innerHTML=e},r=(e,t={})=>Object.assign(document.createElement(e),t);this.attachShadow({mode:"open"}).append(r("style",{textContent:":host{display:var(--snow-ui-display, block);position:fixed;bottom:5px;left:5px;max-width:300px;background:var(--quotebackground,beige);color:black;opacity:0.75;padding:5px;border-radius:5px;border:1px solid darkred;text-align:left;font:18px Arial}"}),this.div=r("div",{innerHTML:a(0)})),this.onmouseover=()=>clearInterval(i),this.onmouseout=()=>n(),this.onclick=()=>o(),n()}});let g=null;const w=async()=>{try{g=await navigator.wakeLock.request("screen"),g.addEventListener("release",(()=>{}))}catch(e){}};document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState?w():null!==g&&g.release().then((()=>{g=null}))})),w()})();